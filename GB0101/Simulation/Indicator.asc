Version 4
SHEET 1 5544 2000
WIRE 1072 -1312 528 -1312
WIRE 1792 -1312 1072 -1312
WIRE 528 -1248 528 -1312
WIRE 736 -1248 528 -1248
WIRE 880 -1248 736 -1248
WIRE 1072 -1248 1072 -1312
WIRE 1072 -1248 880 -1248
WIRE 1296 -1248 1072 -1248
WIRE 1440 -1248 1296 -1248
WIRE 1648 -1248 1440 -1248
WIRE 1792 -1248 1792 -1312
WIRE 1792 -1248 1648 -1248
WIRE 1072 -1184 1072 -1248
WIRE 1792 -1184 1792 -1248
WIRE 1792 -1184 1072 -1184
WIRE 528 -1168 528 -1248
WIRE 1072 -1168 1072 -1184
WIRE 1072 -1168 528 -1168
WIRE 1072 -1120 1072 -1168
WIRE 1792 -1120 1792 -1184
WIRE 1792 -1120 1072 -1120
WIRE 528 -1104 528 -1168
WIRE 1072 -1104 1072 -1120
WIRE 1072 -1104 528 -1104
WIRE 528 -1040 528 -1104
WIRE 736 -1040 736 -1248
WIRE 736 -1040 528 -1040
WIRE 880 -1040 880 -1248
WIRE 880 -1040 736 -1040
WIRE 1072 -1040 1072 -1104
WIRE 1072 -1040 880 -1040
WIRE 1296 -1040 1296 -1248
WIRE 1296 -1040 1072 -1040
WIRE 1440 -1040 1440 -1248
WIRE 1440 -1040 1296 -1040
WIRE 1552 -1040 1440 -1040
WIRE 1648 -1040 1648 -1248
WIRE 1648 -1040 1552 -1040
WIRE 1792 -1040 1792 -1120
WIRE 1792 -1040 1648 -1040
WIRE 528 -960 528 -1040
WIRE 880 -960 528 -960
WIRE 1056 -960 880 -960
WIRE 1248 -960 1056 -960
WIRE 1392 -960 1248 -960
WIRE 1552 -960 1552 -1040
WIRE 1552 -960 1392 -960
WIRE 528 -880 528 -960
WIRE 880 -880 880 -960
WIRE 880 -880 528 -880
WIRE 1056 -880 1056 -960
WIRE 1056 -880 880 -880
WIRE 1120 -880 1056 -880
WIRE 1168 -880 1120 -880
WIRE 1248 -880 1248 -960
WIRE 1248 -880 1168 -880
WIRE 1392 -880 1392 -960
WIRE 1392 -880 1248 -880
WIRE 1552 -880 1552 -960
WIRE 1552 -880 1392 -880
WIRE 528 -816 528 -880
WIRE 880 -816 880 -880
WIRE 880 -816 528 -816
WIRE 528 -752 528 -816
WIRE 880 -752 880 -816
WIRE 880 -752 528 -752
WIRE 1120 -752 1120 -880
WIRE 1120 -752 944 -752
WIRE 1344 -752 1120 -752
WIRE 1488 -752 1344 -752
WIRE 528 -688 528 -752
WIRE 880 -688 880 -752
WIRE 880 -688 528 -688
WIRE 944 -688 944 -752
WIRE 1488 -688 1488 -752
WIRE 1488 -688 944 -688
WIRE 1120 -624 1120 -752
WIRE 1168 -624 1168 -880
WIRE 1168 -624 1120 -624
WIRE 1344 -624 1344 -752
WIRE 1344 -624 1168 -624
WIRE 528 -592 528 -688
WIRE 880 -592 880 -688
WIRE 880 -592 528 -592
WIRE 1552 -592 1552 -880
WIRE 1552 -592 880 -592
WIRE 528 -512 528 -592
WIRE 896 -512 528 -512
WIRE 1072 -512 896 -512
WIRE 1248 -512 1072 -512
WIRE 1408 -512 1248 -512
WIRE 1552 -512 1552 -592
WIRE 1552 -512 1408 -512
WIRE 896 -448 896 -512
WIRE 1072 -448 1072 -512
WIRE 1072 -448 896 -448
WIRE 1120 -448 1072 -448
WIRE 1184 -448 1120 -448
WIRE 1248 -448 1248 -512
WIRE 1248 -448 1184 -448
WIRE 1360 -448 1248 -448
WIRE 1408 -448 1408 -512
WIRE 1408 -448 1360 -448
WIRE 1552 -448 1552 -512
WIRE 1552 -448 1408 -448
WIRE 528 -432 528 -512
WIRE 896 -432 896 -448
WIRE 896 -432 528 -432
WIRE 528 -368 528 -432
WIRE 896 -368 896 -432
WIRE 896 -368 528 -368
WIRE 1520 -368 944 -368
WIRE 944 -320 944 -368
WIRE 1360 -320 1360 -448
WIRE 1360 -320 944 -320
WIRE 1520 -320 1520 -368
WIRE 1520 -320 1360 -320
WIRE 528 -304 528 -368
WIRE 896 -304 896 -368
WIRE 896 -304 528 -304
WIRE 528 -240 528 -304
WIRE 896 -240 896 -304
WIRE 896 -240 528 -240
WIRE 1120 -176 1120 -448
WIRE 1184 -176 1184 -448
WIRE 1184 -176 1120 -176
WIRE 2240 -176 2240 -208
WIRE 528 -160 528 -240
WIRE 896 -160 896 -240
WIRE 896 -160 528 -160
WIRE 1552 -160 1552 -448
WIRE 1552 -160 896 -160
WIRE 64 -112 -80 -112
WIRE 2240 -80 2240 -96
WIRE 2400 -80 2240 -80
WIRE 2576 -80 2400 -80
WIRE 2688 -80 2576 -80
WIRE -80 -64 -80 -112
WIRE 64 -48 64 -112
WIRE 112 -48 64 -48
WIRE 416 -48 112 -48
WIRE 512 -48 416 -48
WIRE 624 -48 512 -48
WIRE 112 -32 112 -48
WIRE 2192 0 2096 0
WIRE 2400 16 2240 16
WIRE 2352 32 2352 0
WIRE 2352 32 2288 32
WIRE 3008 32 3008 -16
WIRE 3008 32 2928 32
WIRE 800 48 656 48
WIRE 2240 48 2240 16
WIRE 112 64 112 32
WIRE 1536 80 944 80
WIRE 416 96 416 -48
WIRE 512 96 512 -48
WIRE 3008 96 2928 96
WIRE 624 112 624 32
WIRE 800 112 624 112
WIRE 3008 128 3008 96
WIRE 64 144 64 -48
WIRE 2240 176 2240 144
WIRE 512 208 512 160
WIRE 624 208 624 112
WIRE 624 208 512 208
WIRE -80 240 -80 -64
WIRE 64 240 64 224
WIRE 304 240 64 240
WIRE 512 240 512 208
WIRE 64 272 64 240
WIRE 704 288 704 224
WIRE 2240 288 2240 256
WIRE 2400 288 2240 288
WIRE 2576 288 2400 288
WIRE 2928 288 2576 288
WIRE 3008 320 3008 208
WIRE 3008 320 2816 320
WIRE 3200 320 3008 320
WIRE 2816 336 2816 320
WIRE 3008 336 3008 320
WIRE 3200 336 3200 320
WIRE 2192 368 2096 368
WIRE -80 384 -80 320
WIRE 64 384 64 352
WIRE 2400 384 2240 384
WIRE 304 400 304 240
WIRE 656 400 656 48
WIRE 656 400 304 400
WIRE 2352 400 2352 368
WIRE 2352 400 2288 400
WIRE 2240 416 2240 384
WIRE 2688 416 2688 -80
WIRE 2768 416 2688 416
WIRE 2928 416 2928 288
WIRE 2960 416 2928 416
WIRE 704 432 704 368
WIRE 2816 464 2816 432
WIRE 3008 464 3008 432
WIRE 3008 464 2816 464
WIRE 3200 464 3200 432
WIRE 3200 464 3008 464
WIRE 3008 512 3008 464
WIRE 64 528 -80 528
WIRE 3152 544 3152 416
WIRE 3152 544 2640 544
WIRE 512 560 512 320
WIRE -80 576 -80 528
WIRE 2240 576 2240 544
WIRE 1648 592 1648 560
WIRE 64 640 64 528
WIRE 3008 672 3008 624
WIRE 3008 672 2944 672
WIRE 2240 688 2240 656
WIRE 2400 688 2240 688
WIRE 2576 688 2400 688
WIRE 2640 688 2640 544
WIRE 2640 688 2576 688
WIRE 1648 704 1648 672
WIRE 1744 704 1648 704
WIRE -80 736 -80 576
WIRE 3008 736 2944 736
WIRE 3024 736 3008 736
WIRE 64 752 64 720
WIRE 816 752 64 752
WIRE 64 768 64 752
WIRE 2096 768 2096 368
WIRE 2192 768 2096 768
WIRE 3008 768 3008 736
WIRE 1552 784 960 784
WIRE 1600 784 1552 784
WIRE 2400 784 2240 784
WIRE 2352 800 2352 768
WIRE 2352 800 2288 800
WIRE 304 816 304 400
WIRE 816 816 304 816
WIRE 2240 816 2240 784
WIRE 1648 832 1648 800
WIRE -80 880 -80 816
WIRE 64 880 64 848
WIRE 3008 896 3008 848
WIRE 3008 896 2816 896
WIRE 3200 896 3008 896
WIRE 2816 928 2816 896
WIRE 3008 928 3008 896
WIRE 3200 928 3200 896
WIRE 2688 1008 2688 416
WIRE 2768 1008 2688 1008
WIRE 2960 1008 2928 1008
WIRE 2816 1056 2816 1024
WIRE 3008 1056 3008 1024
WIRE 3008 1056 2816 1056
WIRE 3200 1056 3200 1024
WIRE 3200 1056 3008 1056
WIRE 64 1072 -80 1072
WIRE 2240 1072 2240 1040
WIRE 1648 1088 1648 1056
WIRE -80 1120 -80 1072
WIRE 3008 1120 3008 1056
WIRE 64 1184 64 1072
WIRE 2240 1184 2240 1152
WIRE 2400 1184 2240 1184
WIRE 2592 1184 2400 1184
WIRE 2928 1184 2928 1008
WIRE 2928 1184 2592 1184
WIRE 1648 1200 1648 1168
WIRE 1744 1200 1648 1200
WIRE 2192 1264 2096 1264
WIRE -80 1280 -80 1120
WIRE 64 1280 64 1264
WIRE 1552 1280 64 1280
WIRE 1600 1280 1552 1280
WIRE 2400 1280 2240 1280
WIRE 2352 1296 2352 1264
WIRE 2352 1296 2288 1296
WIRE 64 1312 64 1280
WIRE 2240 1312 2240 1280
WIRE 1648 1328 1648 1296
WIRE -80 1424 -80 1360
WIRE 64 1424 64 1392
WIRE 2240 1456 2240 1424
WIRE 2240 1568 2240 1536
WIRE 2400 1568 2240 1568
WIRE 2592 1568 2400 1568
WIRE 3152 1568 3152 1008
WIRE 3152 1568 2592 1568
WIRE 1552 1584 64 1584
WIRE 2096 1648 2096 1264
WIRE 2192 1648 2096 1648
WIRE 2400 1664 2240 1664
WIRE 2352 1680 2352 1648
WIRE 2352 1680 2288 1680
WIRE 2240 1696 2240 1664
WIRE 64 1792 64 1584
WIRE 64 1936 64 1872
FLAG 64 384 0
FLAG 832 0 0
FLAG -80 384 0
FLAG -80 -64 V_33
FLAG 112 64 0
FLAG 512 560 0
FLAG 848 704 0
FLAG 848 864 V_33
FLAG 64 880 0
FLAG -80 880 0
FLAG -80 576 V_BAT
FLAG 832 160 V_33
FLAG 304 240 REG1.65
FLAG 704 432 0
FLAG 704 224 BUTTON
FLAG 64 1424 0
FLAG -80 1424 0
FLAG -80 1120 V_BUS
FLAG 1552 1584 C
FLAG 1552 1280 D
FLAG 1552 784 A
FLAG 1536 80 nB
FLAG 1648 1328 0
FLAG 1648 1056 V_33
FLAG 2240 1040 V_33
FLAG 2240 1312 0
FLAG 2240 144 V_33
FLAG 2240 416 0
FLAG 2240 -208 V_33
FLAG 2240 48 0
FLAG 2240 544 V_33
FLAG 2240 816 0
FLAG 2240 1424 V_33
FLAG 2240 1696 0
FLAG 3008 -16 V_33
FLAG 3008 624 V_33
FLAG 3008 1120 0
FLAG 3008 512 0
FLAG 1744 1200 nD
FLAG 1648 832 0
FLAG 1648 560 V_33
FLAG 1744 704 nA
FLAG 2096 0 C
FLAG 2288 32 nD
FLAG 2096 368 nA
FLAG 2288 800 nD
FLAG 2288 400 nB
FLAG 2288 1296 nB
FLAG 2288 1680 nD
FLAG 2096 1264 A
FLAG 2576 -80 nCD
FLAG 2576 288 AB
FLAG 2576 688 AD
FLAG 2592 1184 nAB
FLAG 2592 1568 nAD
FLAG 64 1936 0
SYMBOL res 48 128 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 1Meg
SYMATTR InstName R1
SYMBOL voltage -80 224 R0
WINDOW 3 22 94 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value 3.3
SYMATTR InstName V1
SYMBOL cap 96 -32 R0
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL cap 496 96 R0
SYMATTR InstName C2
SYMATTR Value 4.7µ
SYMBOL res 496 224 R0
SYMATTR InstName R4
SYMATTR Value 1Meg
SYMBOL res 2992 752 R0
SYMATTR InstName R5
SYMATTR Value 50
SYMBOL res 608 -64 R0
WINDOW 3 50 8 Left 2
SYMATTR Value R=if(V(button)>1,0.1,10G)
SYMATTR InstName R6
SYMBOL diode 2992 672 R0
SYMATTR InstName Dred
SYMATTR Value 1N914
SYMATTR Description Light Emitting Diode
SYMATTR Type led
SYMBOL res 2992 112 R0
SYMATTR InstName R2
SYMATTR Value 50
SYMBOL diode 2992 32 R0
SYMATTR InstName Dgreen
SYMATTR Value 1N914
SYMATTR Description Light Emitting Diode
SYMATTR Type led
SYMBOL res 48 256 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 1Meg
SYMATTR InstName R7
SYMBOL cap 400 96 R0
SYMATTR InstName C3
SYMATTR Value 4.7µ
SYMBOL Opamps\\LTC2063 832 80 M180
SYMATTR InstName U2
SYMBOL Opamps\\LTC2063 848 784 M180
SYMATTR InstName U1
SYMBOL res 48 624 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 1.35Meg
SYMATTR InstName R10
SYMBOL res 48 752 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 1.65Meg
SYMATTR InstName R11
SYMBOL voltage -80 720 R0
WINDOW 3 -94 214 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(2.5 4 0 1p 1p 10 20 1000)
SYMATTR InstName V5
SYMBOL voltage 704 272 R0
WINDOW 3 313 238 Right 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 3.3 10 1p 1p 14m 20s 200)
SYMATTR InstName V2
SYMBOL res 48 1168 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 1.7Meg
SYMATTR InstName R3
SYMBOL res 48 1296 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 3.3Meg
SYMATTR InstName R8
SYMBOL voltage -80 1264 R0
WINDOW 3 -119 208 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 5 0 1p 1p 20 40 1000)
SYMATTR InstName V3
SYMBOL res 1632 1072 R0
SYMATTR InstName R12
SYMATTR Value 3Meg
SYMBOL res 2224 1056 R0
SYMATTR InstName R13
SYMATTR Value 3Meg
SYMBOL res 2224 -192 R0
SYMATTR InstName R14
SYMATTR Value 3Meg
SYMBOL res 2224 160 R0
SYMATTR InstName R15
SYMATTR Value 3Meg
SYMBOL res 2224 560 R0
SYMATTR InstName R16
SYMATTR Value 3Meg
SYMBOL res 2224 1440 R0
SYMATTR InstName R17
SYMATTR Value 3Meg
SYMBOL res 1632 576 R0
SYMATTR InstName R19
SYMATTR Value 3Meg
SYMBOL nmos 1600 704 R0
SYMATTR InstName M2
SYMATTR Value BSS123
SYMBOL nmos 2192 -80 R0
SYMATTR InstName M3
SYMATTR Value BSS123
SYMBOL nmos 2352 -80 R0
SYMATTR InstName M4
SYMATTR Value BSS123
SYMBOL nmos 2192 288 R0
SYMATTR InstName M5
SYMATTR Value BSS123
SYMBOL nmos 2352 288 R0
SYMATTR InstName M6
SYMATTR Value BSS123
SYMBOL nmos 2192 688 R0
SYMATTR InstName M7
SYMATTR Value BSS123
SYMBOL nmos 2352 688 R0
SYMATTR InstName M8
SYMATTR Value BSS123
SYMBOL nmos 1600 1200 R0
SYMATTR InstName M9
SYMATTR Value BSS123
SYMBOL nmos 2192 1184 R0
SYMATTR InstName M10
SYMATTR Value BSS123
SYMBOL nmos 2352 1184 R0
SYMATTR InstName M13
SYMATTR Value BSS123
SYMBOL nmos 2192 1568 R0
SYMATTR InstName M12
SYMATTR Value BSS123
SYMBOL nmos 2352 1568 R0
SYMATTR InstName M14
SYMATTR Value BSS123
SYMBOL nmos 2768 928 R0
SYMATTR InstName M15
SYMATTR Value BSS123
SYMBOL nmos 2960 928 R0
SYMATTR InstName M16
SYMATTR Value BSS123
SYMBOL nmos 3152 928 R0
SYMATTR InstName M17
SYMATTR Value BSS123
SYMBOL nmos 2768 336 R0
SYMATTR InstName M18
SYMATTR Value BSS123
SYMBOL nmos 2960 336 R0
SYMATTR InstName M19
SYMATTR Value BSS123
SYMBOL nmos 3152 336 R0
SYMATTR InstName M20
SYMATTR Value BSS123
SYMBOL voltage 64 1776 R0
WINDOW 3 -119 208 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 3.3 0 1p 1p 5 10 10000)
SYMATTR InstName V4
SYMBOL cap 2912 32 R0
SYMATTR InstName C4
SYMATTR Value 10000µ
SYMBOL cap 2928 672 R0
SYMATTR InstName C5
SYMATTR Value 10000µ
TEXT 440 640 Left 2 !.tran 0 100s 0 1m startup uic
TEXT 3136 88 Left 2 ;GREEN
TEXT 3088 712 Left 2 ;RED
TEXT 1312 -1224 Left 2 ;CHARGING
TEXT 1464 -1224 Left 2 ;NOT CHARGING
TEXT 1680 -1224 Left 2 ;FAULT
TEXT 1184 -1152 Left 2 ;LOW BAT
TEXT 1128 -1096 Left 2 ;NOT LOW BAT
TEXT 1352 -1152 Left 2 ;G,R
TEXT 1680 -1152 Left 2 ;BLK
TEXT 1480 -1152 Left 2 ;NOT POSSIBLE
TEXT 1352 -1088 Left 2 ;G,R
TEXT 1680 -1088 Left 2 ;BLK
TEXT 1536 -1088 Left 2 ;G
TEXT 976 760 Left 2 ;HIGH: REGULAR BATTERY,    LOW: LOW BATTERY
TEXT 832 1552 Left 2 ;HIGH: NOT CHARGING,    LOW: CHARGING,    BLINK: FAULT
TEXT 960 -920 Left 2 ;00
TEXT 1128 -920 Left 2 ;01
TEXT 1288 -920 Left 2 ;11
TEXT 672 -848 Left 2 ;00
TEXT 672 -784 Left 2 ;01
TEXT 672 -720 Left 2 ;11
TEXT 672 -656 Left 2 ;10
TEXT 560 -928 Left 2 ;LEVEL,BUTTON  \\  STAT,USB
TEXT 1448 -920 Left 2 ;10
TEXT 560 -1000 Left 2 ;Green table  G = !CD + AB + AD = !(C+!D) + !(!A+!B) + !(!A+!D)
TEXT 1136 -848 Left 2 ;1
TEXT 1136 -784 Left 2 ;1
TEXT 1136 -720 Left 2 ;1
TEXT 1136 -656 Left 2 ;1
TEXT 1296 -848 Left 2 ;0
TEXT 1296 -784 Left 2 ;0
TEXT 1296 -720 Left 2 ;1
TEXT 1296 -656 Left 2 ;1
TEXT 968 -480 Left 2 ;00
TEXT 1136 -480 Left 2 ;01
TEXT 1296 -480 Left 2 ;11
TEXT 680 -408 Left 2 ;00
TEXT 680 -344 Left 2 ;01
TEXT 680 -280 Left 2 ;11
TEXT 680 -216 Left 2 ;10
TEXT 576 -488 Left 2 ;LEVEL,BUTTON  \\  STAT,USB
TEXT 1456 -480 Left 2 ;10
TEXT 576 -544 Left 2 ;Red table  R = !CD + !AB + !AD = !(C+!D) + !(A+!B) + !(A+!D)
TEXT 1144 -408 Left 2 ;1
TEXT 1144 -344 Left 2 ;1
TEXT 1144 -280 Left 2 ;1
TEXT 1144 -216 Left 2 ;1
TEXT 1304 -408 Left 2 ;1
TEXT 1304 -344 Left 2 ;1
TEXT 1304 -280 Left 2 ;0
TEXT 1304 -216 Left 2 ;0
TEXT 1456 -848 Left 2 ;0
TEXT 1456 -656 Left 2 ;0
TEXT 1464 -408 Left 2 ;0
TEXT 1464 -216 Left 2 ;0
TEXT 1456 -784 Left 2 ;0
TEXT 1464 -280 Left 2 ;0
TEXT 1464 -344 Left 2 ;1
TEXT 1456 -720 Left 2 ;1
TEXT 976 -408 Left 2 ;x
TEXT 976 -344 Left 2 ;x
TEXT 976 -280 Left 2 ;x
TEXT 976 -216 Left 2 ;x
TEXT 968 -848 Left 2 ;x
TEXT 968 -784 Left 2 ;x
TEXT 968 -720 Left 2 ;x
TEXT 968 -656 Left 2 ;x
TEXT 672 -904 Left 2 ;A,B / C,D
TEXT 680 -464 Left 2 ;A,B / C,D
TEXT 760 -1216 Left 2 ;PRESSED
TEXT 896 -1216 Left 2 ;NOT PRESSED
TEXT 632 -1144 Left 2 ;LOW BAT
TEXT 576 -1080 Left 2 ;NOT LOW BAT
TEXT 800 -1144 Left 2 ;R
TEXT 968 -1144 Left 2 ;OFF
TEXT 800 -1080 Left 2 ;G
TEXT 968 -1080 Left 2 ;OFF
TEXT 1112 -1272 Left 2 ;USB PLUGED IN
TEXT 560 -1264 Left 2 ;USB NOT PLUGED IN
TEXT 968 56 Left 2 ;HIGH: PRESSED,    LOW: NOT PRESSED
TEXT 976 1256 Left 2 ;HIGH: PLUGED IN,    LOW: NOT PLUGED IN
TEXT 1608 -976 Left 2 ;NOT GATES *2 :      !A, !C
TEXT 1608 -944 Left 2 ;2 INPUTS AND GATES * 6
TEXT 1608 -912 Left 2 ;4 INPUTS OR GATES * 2
