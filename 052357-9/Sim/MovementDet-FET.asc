Version 4
SHEET 1 2120 1876
WIRE -288 -64 -288 -112
WIRE 368 -64 -288 -64
WIRE 576 -64 368 -64
WIRE 880 -64 672 -64
WIRE -288 -16 -288 -64
WIRE 368 64 368 -64
WIRE -288 96 -288 64
WIRE -288 128 -528 128
WIRE -128 128 -288 128
WIRE -128 160 -128 128
WIRE -176 176 -384 176
WIRE 368 176 368 144
WIRE 592 176 592 -16
WIRE 592 176 368 176
WIRE 368 208 368 176
WIRE 880 208 880 -64
WIRE -128 288 -128 256
WIRE 0 288 -128 288
WIRE 160 288 80 288
WIRE 320 288 160 288
WIRE -128 320 -128 288
WIRE 368 336 368 304
WIRE -288 352 -288 128
WIRE 880 384 880 288
WIRE 592 448 592 176
WIRE 592 448 368 448
WIRE -128 480 -128 400
WIRE 592 496 592 448
WIRE 368 528 368 448
WIRE -384 560 -384 176
WIRE -176 560 -384 560
WIRE -288 608 -288 432
WIRE -288 608 -528 608
WIRE -128 608 -128 576
WIRE -128 608 -288 608
WIRE 320 608 272 608
WIRE 272 640 272 608
WIRE -288 688 -288 608
WIRE 160 704 160 288
WIRE 368 704 368 624
WIRE 368 704 160 704
WIRE 592 736 592 576
WIRE 592 736 -32 736
WIRE -288 816 -288 768
WIRE -384 896 -384 560
WIRE -384 896 -608 896
WIRE -336 896 -384 896
WIRE 128 896 128 864
WIRE 352 896 352 864
WIRE -608 928 -608 896
WIRE -288 960 -288 912
WIRE -32 960 -32 736
WIRE -32 960 -192 960
WIRE 128 1008 128 976
WIRE 256 1008 128 1008
WIRE 352 1008 352 976
WIRE 560 1008 352 1008
WIRE 704 1008 560 1008
WIRE 128 1024 128 1008
WIRE 352 1024 352 1008
WIRE 560 1024 560 1008
WIRE -608 1072 -608 1008
WIRE -384 1072 -384 896
WIRE -192 1072 -192 960
WIRE -192 1072 -384 1072
WIRE 80 1104 -96 1104
WIRE 256 1104 256 1008
WIRE 304 1104 256 1104
WIRE 512 1104 464 1104
WIRE -96 1168 -96 1104
WIRE 128 1168 128 1120
WIRE 352 1168 352 1120
WIRE 352 1168 128 1168
WIRE 560 1168 560 1120
WIRE 560 1168 352 1168
WIRE 560 1200 560 1168
WIRE -96 1280 -96 1248
WIRE -384 1360 -384 1072
WIRE 464 1360 464 1104
WIRE 464 1360 -384 1360
FLAG -288 96 0
FLAG -288 -112 V_33
FLAG 368 336 0
FLAG -288 960 0
FLAG 880 384 0
FLAG 592 176 Vg_p
FLAG 272 640 0
FLAG -528 128 M+
FLAG -528 608 M-
FLAG 880 -64 V_OUT
FLAG -608 1072 0
FLAG -608 896 MOTOR_DET_EN
FLAG 560 1200 0
FLAG 352 864 V_33
FLAG 128 864 V_33
FLAG -96 1280 0
FLAG 704 1008 PWM_MOTOR_OUT
FLAG -96 1104 PWM_MOTOR
FLAG -496 640 0
FLAG -496 96 0
FLAG 160 288 Vg_n
SYMBOL voltage -288 -32 R0
WINDOW 3 29 88 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value 3.3
SYMATTR InstName V1
SYMBOL nmos 320 208 R0
SYMATTR InstName M1
SYMATTR Value BSS123
SYMBOL current -288 352 R0
WINDOW 3 37 74 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value SINE(0 0.01 0.1 0 0 0 100)
SYMATTR InstName I1
SYMBOL res -144 304 R0
SYMATTR InstName Rsns
SYMATTR Value 3300
SYMBOL res 352 48 R0
SYMATTR InstName R2
SYMATTR Value 3Meg
SYMBOL pmos 672 -16 M270
SYMATTR InstName M2
SYMATTR Value AO6407
SYMBOL nmos -336 816 R0
SYMATTR InstName M4
SYMATTR Value BSC016N04LS
SYMBOL res 864 192 R0
SYMATTR InstName R3
SYMATTR Value 3Meg
SYMBOL nmos 320 528 R0
SYMATTR InstName M3
SYMATTR Value BSS123
SYMBOL ind -304 672 R0
SYMATTR InstName L1
SYMATTR Value 2.2µ
SYMBOL voltage -608 912 R0
WINDOW 3 29 88 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value 3.3
SYMATTR InstName V2
SYMBOL nmos 80 1024 R0
SYMATTR InstName M6
SYMATTR Value BSS123
SYMBOL nmos 304 1024 R0
SYMATTR InstName M7
SYMATTR Value BSS123
SYMBOL nmos 512 1024 R0
SYMATTR InstName M8
SYMATTR Value BSS123
SYMBOL res 336 880 R0
SYMATTR InstName R4
SYMATTR Value 3Meg
SYMBOL res 112 880 R0
SYMATTR InstName R5
SYMATTR Value 3Meg
SYMBOL voltage -96 1152 R0
WINDOW 3 29 88 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 3.3 0 1p 1p 1 2 1000)
SYMATTR InstName V3
SYMBOL res 576 480 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL voltage -496 320 R0
WINDOW 3 29 88 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value -12
SYMATTR InstName V4
SYMBOL res 96 272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL nmos -176 480 R0
SYMATTR InstName M5
SYMATTR Value BSC016N03LS
SYMBOL nmos -176 256 M180
SYMATTR InstName M9
SYMATTR Value BSC016N03LS
TEXT -560 768 Left 2 !.tran 50
TEXT -1160 552 Left 2 ;M5 and M9 shut down the Rsns when MOTOR_DET_EN=0
TEXT 96 192 Left 2 ;M1 is open when I1 >0
TEXT 232 424 Left 2 ;M3 is open when I1 <0
TEXT -888 1120 Left 2 ;M4 set M- to GND when MOTOR_DET_EN=1
TEXT -992 1152 Left 2 ;M4 set M+ and M- floating when MOTOR_DET_EN=0
TEXT 672 1056 Left 2 ;PWM_MOTOR_OUT = ~(~PWM_MOTOR | MOTOR_DET_EN)
TEXT 680 544 Left 2 ;R6 and R7 is current limitor
