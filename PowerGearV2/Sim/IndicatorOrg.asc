Version 4
SHEET 1 5544 3296
WIRE 784 -1584 240 -1584
WIRE 1504 -1584 784 -1584
WIRE 240 -1520 240 -1584
WIRE 448 -1520 240 -1520
WIRE 592 -1520 448 -1520
WIRE 784 -1520 784 -1584
WIRE 784 -1520 592 -1520
WIRE 1008 -1520 784 -1520
WIRE 1152 -1520 1008 -1520
WIRE 1360 -1520 1152 -1520
WIRE 1504 -1520 1504 -1584
WIRE 1504 -1520 1360 -1520
WIRE 240 -1440 240 -1520
WIRE 784 -1440 784 -1520
WIRE 784 -1440 240 -1440
WIRE 1504 -1440 1504 -1520
WIRE 1504 -1440 784 -1440
WIRE 240 -1376 240 -1440
WIRE 784 -1376 784 -1440
WIRE 784 -1376 240 -1376
WIRE 1504 -1376 1504 -1440
WIRE 1504 -1376 784 -1376
WIRE 240 -1312 240 -1376
WIRE 448 -1312 448 -1520
WIRE 448 -1312 240 -1312
WIRE 592 -1312 592 -1520
WIRE 592 -1312 448 -1312
WIRE 784 -1312 784 -1376
WIRE 784 -1312 592 -1312
WIRE 1008 -1312 1008 -1520
WIRE 1008 -1312 784 -1312
WIRE 1152 -1312 1152 -1520
WIRE 1152 -1312 1008 -1312
WIRE 1360 -1312 1360 -1520
WIRE 1360 -1312 1152 -1312
WIRE 1504 -1312 1504 -1376
WIRE 1504 -1312 1360 -1312
WIRE 1888 -1312 1504 -1312
WIRE 240 -1232 240 -1312
WIRE 592 -1232 240 -1232
WIRE 752 -1232 592 -1232
WIRE 912 -1232 752 -1232
WIRE 1072 -1232 912 -1232
WIRE 1248 -1232 1072 -1232
WIRE 1408 -1232 1248 -1232
WIRE 1568 -1232 1408 -1232
WIRE 1728 -1232 1568 -1232
WIRE 1888 -1232 1888 -1312
WIRE 1888 -1232 1728 -1232
WIRE 240 -1136 240 -1232
WIRE 592 -1136 592 -1232
WIRE 592 -1136 240 -1136
WIRE 752 -1136 752 -1232
WIRE 752 -1136 592 -1136
WIRE 912 -1136 912 -1232
WIRE 912 -1136 752 -1136
WIRE 1072 -1136 1072 -1232
WIRE 1072 -1136 912 -1136
WIRE 1248 -1136 1248 -1232
WIRE 1248 -1136 1072 -1136
WIRE 1408 -1136 1408 -1232
WIRE 1408 -1136 1248 -1136
WIRE 1568 -1136 1568 -1232
WIRE 1568 -1136 1408 -1136
WIRE 1728 -1136 1728 -1232
WIRE 1728 -1136 1568 -1136
WIRE 1888 -1136 1888 -1232
WIRE 1888 -1136 1728 -1136
WIRE 1680 -1072 1472 -1072
WIRE 240 -1056 240 -1136
WIRE 592 -1056 592 -1136
WIRE 592 -1056 240 -1056
WIRE 1520 -1056 976 -1056
WIRE 240 -992 240 -1056
WIRE 592 -992 592 -1056
WIRE 592 -992 240 -992
WIRE 1840 -992 656 -992
WIRE 976 -960 976 -1056
WIRE 1520 -960 1520 -1056
WIRE 1520 -960 976 -960
WIRE 1472 -944 1472 -1072
WIRE 1680 -944 1680 -1072
WIRE 1680 -944 1472 -944
WIRE 240 -928 240 -992
WIRE 592 -928 592 -992
WIRE 592 -928 240 -928
WIRE 656 -896 656 -992
WIRE 1840 -896 1840 -992
WIRE 1840 -896 656 -896
WIRE 240 -848 240 -928
WIRE 592 -848 592 -928
WIRE 592 -848 240 -848
WIRE 1888 -848 1888 -1136
WIRE 1888 -848 592 -848
WIRE 240 -768 240 -848
WIRE 592 -768 240 -768
WIRE 752 -768 592 -768
WIRE 912 -768 752 -768
WIRE 1072 -768 912 -768
WIRE 1248 -768 1072 -768
WIRE 1408 -768 1248 -768
WIRE 1568 -768 1408 -768
WIRE 1728 -768 1568 -768
WIRE 1888 -768 1888 -848
WIRE 1888 -768 1728 -768
WIRE 240 -672 240 -768
WIRE 592 -672 592 -768
WIRE 592 -672 240 -672
WIRE 752 -672 752 -768
WIRE 752 -672 592 -672
WIRE 912 -672 912 -768
WIRE 912 -672 752 -672
WIRE 1072 -672 1072 -768
WIRE 1072 -672 912 -672
WIRE 1248 -672 1248 -768
WIRE 1248 -672 1072 -672
WIRE 1408 -672 1408 -768
WIRE 1408 -672 1248 -672
WIRE 1568 -672 1568 -768
WIRE 1568 -672 1408 -672
WIRE 1728 -672 1728 -768
WIRE 1728 -672 1568 -672
WIRE 1888 -672 1888 -768
WIRE 1888 -672 1728 -672
WIRE 1200 -656 1136 -656
WIRE 240 -592 240 -672
WIRE 592 -592 592 -672
WIRE 592 -592 240 -592
WIRE 240 -528 240 -592
WIRE 592 -528 592 -592
WIRE 592 -528 240 -528
WIRE 1184 -528 656 -528
WIRE 240 -464 240 -528
WIRE 592 -464 592 -528
WIRE 592 -464 240 -464
WIRE 240 -400 240 -464
WIRE 592 -400 592 -464
WIRE 592 -400 240 -400
WIRE 240 -336 240 -400
WIRE 592 -336 592 -400
WIRE 592 -336 240 -336
WIRE 656 -288 656 -528
WIRE 1184 -288 1184 -528
WIRE 1184 -288 656 -288
WIRE 240 -272 240 -336
WIRE 592 -272 592 -336
WIRE 592 -272 240 -272
WIRE 240 -208 240 -272
WIRE 592 -208 592 -272
WIRE 592 -208 240 -208
WIRE 1840 -208 656 -208
WIRE 656 -160 656 -208
WIRE 1840 -160 1840 -208
WIRE 1840 -160 656 -160
WIRE 1136 -144 1136 -656
WIRE 1200 -144 1200 -656
WIRE 1200 -144 1136 -144
WIRE 240 -128 240 -208
WIRE 592 -128 592 -208
WIRE 592 -128 240 -128
WIRE 1888 -128 1888 -672
WIRE 1888 -128 592 -128
WIRE 512 -48 -224 -48
WIRE 624 -48 512 -48
WIRE 624 -16 624 -48
WIRE 832 64 832 32
WIRE 624 80 624 64
WIRE 800 80 624 80
WIRE 512 96 512 -48
WIRE 1376 96 864 96
WIRE 736 112 688 112
WIRE 800 112 736 112
WIRE 832 160 832 128
WIRE 512 208 512 160
WIRE 624 208 624 80
WIRE 624 208 512 208
WIRE 512 240 512 208
WIRE -224 272 -224 -48
WIRE -224 272 -288 272
WIRE -160 272 -224 272
WIRE 160 272 128 272
WIRE 224 272 160 272
WIRE 272 272 224 272
WIRE 448 272 336 272
WIRE -224 288 -224 272
WIRE 224 288 224 272
WIRE 704 288 704 224
WIRE 160 368 160 272
WIRE 160 368 128 368
WIRE 272 368 272 272
WIRE 384 368 336 368
WIRE -224 384 -224 352
WIRE 224 384 224 352
WIRE 512 432 512 320
WIRE 704 432 704 368
WIRE -16 464 -16 432
WIRE -240 528 -288 528
WIRE 304 528 -240 528
WIRE 448 528 448 272
WIRE 448 528 304 528
WIRE -240 560 -240 528
WIRE 32 560 -48 560
WIRE 448 640 448 528
WIRE 32 656 32 640
WIRE 160 656 32 656
WIRE 192 656 160 656
WIRE -240 672 -240 640
WIRE -112 672 -240 672
WIRE -48 672 -48 560
WIRE -48 672 -112 672
WIRE -240 688 -240 672
WIRE -48 704 -48 672
WIRE 304 736 304 528
WIRE 848 736 848 704
WIRE 32 752 32 736
WIRE 160 752 32 752
WIRE 192 752 160 752
WIRE 448 752 448 720
WIRE 816 752 448 752
WIRE 1120 768 880 768
WIRE 1168 768 1120 768
WIRE 448 784 448 752
WIRE 816 784 704 784
WIRE -240 800 -240 752
WIRE -48 800 -48 768
WIRE 848 832 848 800
WIRE 32 848 32 832
WIRE 160 848 32 848
WIRE 192 848 160 848
WIRE 304 896 304 816
WIRE 448 896 448 864
WIRE 32 944 32 928
WIRE 384 976 384 368
WIRE 384 976 -288 976
WIRE 432 976 384 976
WIRE 576 976 432 976
WIRE 576 1088 576 976
WIRE 432 1184 432 976
WIRE 576 1200 576 1168
WIRE 1136 1200 576 1200
WIRE 1168 1200 1136 1200
WIRE 576 1216 576 1200
WIRE 432 1328 432 1264
WIRE 576 1328 576 1296
WIRE 944 1600 944 1568
WIRE 912 1616 864 1616
WIRE 624 1632 416 1632
WIRE 1376 1632 976 1632
WIRE 912 1648 864 1648
WIRE 624 1664 624 1632
WIRE 944 1696 944 1664
WIRE 624 1776 624 1744
WIRE 864 1776 864 1648
WIRE 864 1776 624 1776
WIRE 416 1792 416 1632
WIRE 624 1808 624 1776
WIRE 944 1904 944 1872
WIRE 864 1920 864 1776
WIRE 912 1920 864 1920
WIRE 416 1936 416 1872
WIRE 624 1936 624 1872
WIRE 1376 1936 976 1936
WIRE 912 1952 864 1952
WIRE 944 2000 944 1968
FLAG 832 32 0
FLAG 512 432 0
FLAG 848 704 0
FLAG 848 832 V3.3V
FLAG 448 896 0
FLAG 304 896 0
FLAG 832 160 V3.3V
FLAG 704 432 0
FLAG 704 224 BUTTON
FLAG 576 1328 0
FLAG 432 1328 0
FLAG -288 976 V_BUS
FLAG 1136 1200 D
FLAG 1120 768 A
FLAG 1376 96 B
FLAG 416 1936 0
FLAG 624 1936 0
FLAG 944 1568 0
FLAG 944 1696 V3.3V
FLAG 944 1872 0
FLAG 944 2000 V3.3V
FLAG 1376 1632 C
FLAG 1376 1936 E
FLAG 864 1616 Vref1.0
FLAG 864 1952 Vref2.0
FLAG 704 784 Vref1.65
FLAG 736 112 Vref1.65
FLAG -288 272 V3.3V
FLAG -16 464 0
FLAG -224 384 0
FLAG 224 384 0
FLAG -288 528 V_BAT
FLAG -240 800 0
FLAG 32 944 0
FLAG 160 752 Vref1.65
FLAG 160 656 Vref2.0
FLAG 160 848 Vref1.0
FLAG -112 672 Vref2.5
FLAG -48 800 0
SYMBOL cap 496 96 R0
SYMATTR InstName C2
SYMATTR Value 4.7µ
SYMBOL res 496 224 R0
SYMATTR InstName R4
SYMATTR Value 1Meg
SYMBOL res 608 -32 R0
WINDOW 3 49 17 Left 2
WINDOW 0 49 45 Left 2
SYMATTR Value R=if(V(button)>1,0.1,10G)
SYMATTR InstName R6
SYMBOL res 432 624 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 1.35Meg
SYMATTR InstName R10
SYMBOL res 432 768 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 1.65Meg
SYMATTR InstName R11
SYMBOL voltage 304 720 R0
WINDOW 3 -76 71 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 -71 42 Left 2
SYMATTR Value 3.7
SYMATTR InstName V5
SYMBOL voltage 704 272 R0
WINDOW 3 436 60 Right 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 42 34 Left 2
SYMATTR Value PULSE(0 3.3 1 1p 1p 14m 20s 200)
SYMATTR InstName V2
SYMBOL res 560 1072 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 1.7Meg
SYMATTR InstName R3
SYMBOL res 560 1200 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 3.3Meg
SYMATTR InstName R8
SYMBOL voltage 432 1168 R0
WINDOW 3 -64 50 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value 0
SYMATTR InstName V3
SYMBOL voltage 416 1776 R0
WINDOW 3 -88 52 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value 3.3
SYMATTR InstName V4
SYMBOL res 608 1648 R0
SYMATTR InstName R20
SYMATTR Value 1Meg
SYMBOL cap 608 1808 R0
SYMATTR InstName C6
SYMATTR Value 10µ
SYMBOL Opamps/LT1672 944 1632 M180
SYMATTR InstName OP3
SYMBOL Opamps/LT1672 944 1936 M180
SYMATTR InstName OP4
SYMBOL Opamps/LT1672 832 96 M180
WINDOW 0 -75 51 Left 2
SYMATTR InstName OP5
SYMBOL Opamps/LT1672 848 768 M180
SYMATTR InstName OP6
SYMBOL PowerProducts\\LT3009-3.3 -16 320 M0
SYMATTR InstName U1
SYMBOL cap 240 288 M0
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL cap -208 288 M0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL schottky 336 256 R90
WINDOW 0 62 32 VBottom 2
WINDOW 3 -43 34 VTop 2
SYMATTR InstName D2
SYMATTR Value BAT54HM
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 336 352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 46 26 VTop 2
SYMATTR InstName D3
SYMATTR Value BAT54HM
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -256 544 R0
WINDOW 3 38 81 Left 2
SYMATTR Value 1Meg
SYMATTR InstName R1
SYMBOL References\\LT1389-2.5 -240 720 R0
SYMATTR InstName D1
SYMBOL res 16 544 R0
SYMATTR InstName R2
SYMATTR Value 500k
SYMBOL res 16 640 R0
SYMATTR InstName R5
SYMATTR Value 350k
SYMBOL res 16 736 R0
SYMATTR InstName R7
SYMATTR Value 650k
SYMBOL res 16 832 R0
SYMATTR InstName R9
SYMATTR Value 1Meg
SYMBOL cap -64 704 R0
SYMATTR InstName C4
SYMATTR Value 1µ
TEXT -176 1024 Left 2 !.tran 0 100s 0 1m startup uic
TEXT 1024 -1488 Left 2 ;CHARGING
TEXT 1176 -1488 Left 2 ;NOT CHARGING
TEXT 1392 -1488 Left 2 ;FAULT
TEXT 848 -1416 Left 2 ;LOW BAT
TEXT 824 -1352 Left 2 ;NOT LOW BAT
TEXT 1064 -1416 Left 2 ;G,R
TEXT 1392 -1416 Left 2 ;BLK(R)
TEXT 1176 -1416 Left 2 ;NOT POSSIBLE
TEXT 1064 -1352 Left 2 ;G,R
TEXT 1392 -1352 Left 2 ;BLK(R)
TEXT 1248 -1352 Left 2 ;G
TEXT 544 672 Left 2 ;HIGH: REGULAR BATTERY,    LOW: LOW BATTERY
TEXT 648 -1184 Left 2 ;000
TEXT 816 -1184 Left 2 ;001
TEXT 976 -1184 Left 2 ;011
TEXT 392 -1096 Left 2 ;00
TEXT 392 -1032 Left 2 ;01
TEXT 392 -968 Left 2 ;11
TEXT 392 -904 Left 2 ;10
TEXT 312 -1216 Left 2 ;NEG,POS/\nLEVEL,BUTTON,USB
TEXT 1144 -1184 Left 2 ;010
TEXT 272 -1272 Left 2 ;Green table  G = C + EB + EAD
TEXT 832 -1104 Left 2 ;0
TEXT 832 -1040 Left 2 ;x
TEXT 832 -976 Left 2 ;x
TEXT 832 -912 Left 2 ;1
TEXT 992 -1104 Left 2 ;0
TEXT 992 -1040 Left 2 ;x
TEXT 992 -976 Left 2 ;x
TEXT 992 -912 Left 2 ;1
TEXT 1152 -1104 Left 2 ;x
TEXT 1152 -912 Left 2 ;x
TEXT 1152 -1040 Left 2 ;1
TEXT 1152 -976 Left 2 ;x
TEXT 664 -1104 Left 2 ;x
TEXT 664 -1040 Left 2 ;0
TEXT 664 -976 Left 2 ;x
TEXT 664 -912 Left 2 ;x
TEXT 312 -1160 Left 2 ;C,E / A,B,D
TEXT 472 -1488 Left 2 ;PRESSED
TEXT 608 -1488 Left 2 ;NOT PRESSED
TEXT 296 -1416 Left 2 ;LOW BAT
TEXT 296 -1352 Left 2 ;FULL BAT
TEXT 512 -1416 Left 2 ;R
TEXT 680 -1416 Left 2 ;OFF
TEXT 512 -1352 Left 2 ;G
TEXT 680 -1352 Left 2 ;OFF
TEXT 1064 -1552 Left 2 ;USB PLUGED IN
TEXT 416 -1552 Left 2 ;USB NOT PLUGED IN
TEXT 896 128 Left 2 ;HIGH: PRESSED,    LOW: NOT PRESSED
TEXT 640 1224 Left 2 ;HIGH: PLUGED IN,    LOW: NOT PLUGED IN
TEXT 1560 -1544 Left 2 ;B:       Button status, 1 pressed, 0 not pressed
TEXT 1560 -1576 Left 2 ;A:       Battery level, 1 full, 0 not full
TEXT 1560 -1512 Left 2 ;D:       USB status, 1 pluged in , 0 not pluged in
TEXT 1560 -1480 Left 2 ;C,E      00, Blinking   01, Not charging   10, Charging   11, Not possible
TEXT 1312 -1184 Left 2 ;110
TEXT 1472 -1184 Left 2 ;111
TEXT 1632 -1184 Left 2 ;101
TEXT 1792 -1184 Left 2 ;100
TEXT 1488 -1104 Left 2 ;0
TEXT 1488 -1040 Left 2 ;1
TEXT 1488 -976 Left 2 ;x
TEXT 1488 -912 Left 2 ;1
TEXT 1648 -1104 Left 2 ;0
TEXT 1648 -1040 Left 2 ;1
TEXT 1648 -976 Left 2 ;x
TEXT 1648 -912 Left 2 ;1
TEXT 1808 -1104 Left 2 ;x
TEXT 1808 -912 Left 2 ;x
TEXT 1808 -1040 Left 2 ;0
TEXT 1808 -976 Left 2 ;x
TEXT 1320 -1104 Left 2 ;x
TEXT 1320 -1040 Left 2 ;1
TEXT 1320 -976 Left 2 ;x
TEXT 1320 -912 Left 2 ;x
TEXT 288 -816 Left 2 ;Red table  R = !AC + !AB!D + !C!EF
TEXT 56 88 Right 2 ;NCP551SN33\n3.3V, 12Vmax\n1uA quiescent current\n$0.2
TEXT 648 -720 Left 2 ;000
TEXT 816 -720 Left 2 ;001
TEXT 976 -720 Left 2 ;011
TEXT 392 -632 Left 2 ;0--00
TEXT 392 -568 Left 2 ;0--01
TEXT 392 -504 Left 2 ;0--11
TEXT 392 -440 Left 2 ;0--10
TEXT 312 -752 Left 2 ;STAT--NEG,POS/\nLEVEL,BUTTON,USB
TEXT 1144 -720 Left 2 ;010
TEXT 800 -640 Left 2 ;STAT(0)
TEXT 832 -576 Left 2 ;x
TEXT 832 -512 Left 2 ;x
TEXT 832 -448 Left 2 ;1
TEXT 992 -576 Left 2 ;x
TEXT 992 -512 Left 2 ;x
TEXT 992 -448 Left 2 ;1
TEXT 1152 -640 Left 2 ;x
TEXT 1152 -448 Left 2 ;x
TEXT 1152 -576 Left 2 ;1
TEXT 1152 -512 Left 2 ;x
TEXT 664 -640 Left 2 ;x
TEXT 664 -576 Left 2 ;0
TEXT 664 -512 Left 2 ;x
TEXT 664 -448 Left 2 ;x
TEXT 312 -696 Left 2 ;F--C,E / A,B,D
TEXT 1312 -720 Left 2 ;110
TEXT 1472 -720 Left 2 ;111
TEXT 1632 -720 Left 2 ;101
TEXT 1792 -720 Left 2 ;100
TEXT 1488 -576 Left 2 ;0
TEXT 1488 -512 Left 2 ;x
TEXT 1488 -448 Left 2 ;0
TEXT 1648 -576 Left 2 ;0
TEXT 1648 -512 Left 2 ;x
TEXT 1648 -448 Left 2 ;0
TEXT 1808 -640 Left 2 ;x
TEXT 1808 -448 Left 2 ;x
TEXT 1808 -576 Left 2 ;0
TEXT 1808 -512 Left 2 ;x
TEXT 1320 -640 Left 2 ;x
TEXT 1320 -576 Left 2 ;0
TEXT 1320 -512 Left 2 ;x
TEXT 1320 -448 Left 2 ;x
TEXT 392 -376 Left 2 ;1--10
TEXT 392 -312 Left 2 ;1--11
TEXT 392 -248 Left 2 ;1--01
TEXT 392 -184 Left 2 ;1--00
TEXT 816 -184 Left 2 ;STAT(1)
TEXT 832 -248 Left 2 ;x
TEXT 832 -312 Left 2 ;x
TEXT 832 -376 Left 2 ;1
TEXT 992 -248 Left 2 ;x
TEXT 992 -312 Left 2 ;x
TEXT 992 -376 Left 2 ;1
TEXT 1152 -184 Left 2 ;x
TEXT 1152 -376 Left 2 ;x
TEXT 1152 -248 Left 2 ;1
TEXT 1152 -312 Left 2 ;x
TEXT 664 -184 Left 2 ;x
TEXT 664 -248 Left 2 ;0
TEXT 664 -312 Left 2 ;x
TEXT 664 -376 Left 2 ;x
TEXT 1488 -248 Left 2 ;0
TEXT 1488 -312 Left 2 ;x
TEXT 1488 -376 Left 2 ;0
TEXT 1648 -248 Left 2 ;0
TEXT 1648 -312 Left 2 ;x
TEXT 1648 -376 Left 2 ;0
TEXT 1808 -184 Left 2 ;x
TEXT 1808 -376 Left 2 ;x
TEXT 1808 -248 Left 2 ;0
TEXT 1808 -312 Left 2 ;x
TEXT 1320 -184 Left 2 ;x
TEXT 1320 -248 Left 2 ;0
TEXT 1320 -312 Left 2 ;x
TEXT 1320 -376 Left 2 ;x
TEXT 960 -640 Left 2 ;STAT(0)
TEXT 1448 -640 Left 2 ;STAT(0)
TEXT 1608 -640 Left 2 ;STAT(0)
TEXT 960 -184 Left 2 ;STAT(1)
TEXT 1448 -184 Left 2 ;STAT(1)
TEXT 1616 -184 Left 2 ;STAT(1)
